# QAToolBox ä¸­å›½éƒ¨ç½² Makefile

.PHONY: help install deploy start stop restart logs status backup monitor update clean

help: ## æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
	@echo "QAToolBox éƒ¨ç½²ç®¡ç†å‘½ä»¤:"
	@echo ""
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | sort | awk 'BEGIN {FS = ":.*?## "}; {printf "  \033[36m%-15s\033[0m %s\n", $$1, $$2}'

install: ## ä¸€é”®å®‰è£…éƒ¨ç½²
	@echo "ğŸš€ å¼€å§‹ä¸€é”®å®‰è£…..."
	@chmod +x deploy_china.sh
	@./deploy_china.sh

deploy: ## éƒ¨ç½²åº”ç”¨
	@echo "ğŸš€ éƒ¨ç½²åº”ç”¨..."
	@docker-compose -f docker-compose.china.yml up -d --build

start: ## å¯åŠ¨æœåŠ¡
	@echo "â–¶ï¸ å¯åŠ¨æœåŠ¡..."
	@docker-compose -f docker-compose.china.yml up -d

stop: ## åœæ­¢æœåŠ¡
	@echo "â¹ï¸ åœæ­¢æœåŠ¡..."
	@docker-compose -f docker-compose.china.yml down

restart: ## é‡å¯æœåŠ¡
	@echo "ğŸ”„ é‡å¯æœåŠ¡..."
	@docker-compose -f docker-compose.china.yml restart

logs: ## æŸ¥çœ‹æ—¥å¿—
	@echo "ğŸ“ æŸ¥çœ‹å®æ—¶æ—¥å¿—..."
	@docker-compose -f docker-compose.china.yml logs -f

status: ## æ£€æŸ¥æœåŠ¡çŠ¶æ€
	@echo "ğŸ“Š æ£€æŸ¥æœåŠ¡çŠ¶æ€..."
	@chmod +x monitor.sh
	@./monitor.sh

backup: ## å¤‡ä»½æ•°æ®
	@echo "ğŸ—„ï¸ å¤‡ä»½æ•°æ®..."
	@chmod +x backup.sh
	@./backup.sh

update: ## æ›´æ–°ä»£ç å¹¶é‡æ–°éƒ¨ç½²
	@echo "ğŸ”„ æ›´æ–°ä»£ç ..."
	@git pull origin main
	@docker-compose -f docker-compose.china.yml up -d --build

clean: ## æ¸…ç†Dockerç¼“å­˜
	@echo "ğŸ§¹ æ¸…ç†Dockerç¼“å­˜..."
	@docker system prune -f
	@docker volume prune -f

monitor: ## æŒç»­ç›‘æ§æœåŠ¡
	@echo "ğŸ‘ï¸ æŒç»­ç›‘æ§æœåŠ¡ (Ctrl+Cé€€å‡º)..."
	@while true; do \
		clear; \
		make status; \
		sleep 30; \
	done

