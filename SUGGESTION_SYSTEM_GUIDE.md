# 建议系统使用指南

## 快速测试步骤

### 1. 启动服务器
```bash
python manage.py runserver
```

### 2. 测试普通用户功能

#### 2.1 使用普通用户登录
- 访问：http://localhost:8000/users/login/
- 用户名：testuser
- 密码：testpass123
- 验证码：任意输入（系统会验证）

#### 2.2 提交建议
1. 登录后点击"我的建议"
2. 点击"提交建议"
3. 填写建议信息：
   - 标题：测试建议
   - 内容：这是一个测试建议
   - 类型：功能建议
4. 点击"提交建议"

#### 2.3 查看自己的建议
- 在建议列表中应该只能看到自己提交的建议
- 可以看到建议状态和管理员回复

### 3. 测试管理员功能

#### 3.1 使用管理员登录
- 访问：http://localhost:8000/users/login/
- 用户名：shinytsing1
- 密码：您设置的密码
- 验证码：任意输入

#### 3.2 查看所有建议
1. 登录后在用户下拉菜单中点击"建议管理"
2. 应该能看到所有用户提交的建议
3. 可以看到建议的详细信息

#### 3.3 回复建议
1. 点击建议的"查看"按钮
2. 在回复框中输入回复内容
3. 选择建议状态（如：已处理）
4. 点击"保存回复"

### 4. 权限验证测试

#### 4.1 普通用户权限
- 登录普通用户账号
- 访问建议管理页面
- 应该只能看到自己的建议

#### 4.2 管理员权限
- 登录管理员账号
- 访问建议管理页面
- 应该能看到所有用户的建议

#### 4.3 未登录用户
- 不登录直接访问建议API
- 应该看不到任何建议

## 常见问题解决

### 1. 登录页面错误
如果登录页面显示500错误，检查：
- URL配置是否正确
- 验证码功能是否正常

### 2. 建议提交失败
如果建议提交失败，检查：
- CSRF token是否正确
- 用户是否已登录
- 建议内容是否完整

### 3. 权限控制问题
如果权限控制不正确，检查：
- 用户角色是否正确设置
- 建议是否与用户正确关联

## 测试数据

### 当前测试数据
- 管理员用户：shinytsing1
- 普通用户：testuser
- 现有建议：3条

### 创建测试用户
如果需要创建新的测试用户：
```bash
python manage.py createsuperuser
```

### 设置用户角色
```bash
python manage.py set_admin <用户名>
```

## API测试

### 获取建议列表
```bash
curl http://localhost:8000/content/api/suggestions/
```

### 提交建议
```bash
curl -X POST http://localhost:8000/content/api/suggestions/ \
  -H "Content-Type: application/json" \
  -H "X-CSRFToken: <token>" \
  -d '{
    "title": "测试建议",
    "content": "这是一个测试建议",
    "suggestion_type": "feature",
    "user_name": "测试用户",
    "user_email": "test@example.com"
  }'
```

## 功能验证清单

- [ ] 普通用户可以提交建议
- [ ] 普通用户只能看到自己的建议
- [ ] 管理员可以看到所有建议
- [ ] 管理员可以回复建议
- [ ] 管理员可以更改建议状态
- [ ] 未登录用户无法看到建议
- [ ] 建议与用户正确关联
- [ ] 建议状态正确显示
- [ ] 管理员回复正确保存

## 联系支持

如果遇到问题，请检查：
1. 服务器是否正常运行
2. 数据库连接是否正常
3. 用户权限是否正确设置
4. 浏览器控制台是否有错误信息 