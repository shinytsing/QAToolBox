{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" type="text/css" href="{% static 'geek.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'punk.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'rage.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'emo.css' %}">
{% endblock %}

{% block content %}
{% if user.is_authenticated %}
<div id="tool-container" class="geek-card">
  <div id="tool-title" class="geek-title">ä¸“ä¸šæ•ˆç‡ä¸­å¿ƒ</div>
  
  <!-- å„æ¨¡å¼çš„terminal div -->
  <div id="tool-terminal" class="geek-terminal"></div>
  <div id="life-terminal" class="punk-terminal" style="display: none;"></div>
  <div id="training-terminal" class="rage-terminal" style="display: none;"></div>
  <div id="emo-terminal" class="emo-terminal" style="display: none;"></div>
  

  
  <div id="tool-grid" class="geek-tool-grid">
    <!-- å·¥å…·å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
  </div>
</div>
{% else %}
<div class="geek-card">
  <div class="geek-title">ğŸ”’ éœ€è¦ç™»å½•</div>
  <div class="geek-terminal">
    <p style="text-align: center; color: #666; margin: 20px 0;">
      è¯·å…ˆç™»å½•ä»¥ä½¿ç”¨æˆ‘ä»¬çš„å·¥å…·åŠŸèƒ½
    </p>
    <div style="text-align: center;">
      <a href="{% url 'login' %}" class="geek-auth-btn" style="margin-right: 10px;">
        <i class="fas fa-sign-in-alt"></i> ç™»å½•
      </a>
      <a href="{% url 'register' %}" class="geek-auth-btn">
        <i class="fas fa-user-plus"></i> æ³¨å†Œ
      </a>
    </div>
  </div>
</div>
{% endif %}

<style>
/* æ¨¡å¼åˆ‡æ¢å™¨å·²ç§»é™¤ï¼Œä¸»é¢˜åˆ‡æ¢åŠŸèƒ½ç§»è‡³å¯¼èˆªèœå• */

/* ä¸»é¢˜åˆ‡æ¢ä¼˜åŒ– - ç¡®ä¿æµç•…åˆ‡æ¢ */
body.work-theme .geek-card,
body.work-theme .geek-title,
body.work-theme .geek-terminal,
body.work-theme .geek-tool-grid,
body.work-theme .geek-tool-card {
    display: block !important;
}

body.life-theme .punk-card,
body.life-theme .punk-title,
body.life-theme .punk-terminal,
body.life-theme .punk-tool-grid,
body.life-theme .punk-tool-card {
    display: block !important;
}

body.training-theme .rage-card,
body.training-theme .rage-title,
body.training-theme .rage-terminal,
body.training-theme .rage-tool-grid,
body.training-theme .rage-tool-card {
    display: block !important;
}

body.emo-theme .emo-card,
body.emo-theme .emo-title,
body.emo-theme .emo-terminal,
body.emo-theme .emo-tool-grid,
body.emo-theme .emo-tool-card {
    display: block !important;
}

/* é˜²æ­¢å¸ƒå±€æŠ–åŠ¨çš„å…³é”®æ ·å¼ */
#tool-container {
    min-height: 100vh;
    contain: layout style paint;
    will-change: auto;
}

.tool-grid-container {
    contain: layout style paint;
    will-change: auto;
}

/* ç¡®ä¿å·¥å…·å¡ç‰‡åœ¨åˆ‡æ¢æ—¶ä¿æŒç¨³å®š */
.tool-card {
    contain: layout style paint;
    will-change: auto;
    transform: translateZ(0);
}

/* é˜²æ­¢å­—ä½“åŠ è½½å¯¼è‡´çš„å¸ƒå±€æŠ–åŠ¨ */
body {
    font-display: swap;
}

/* ä¼˜åŒ–CSSåˆ‡æ¢æ€§èƒ½ */
* {
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
}

/* è¦†ç›–punk.cssä¸­çš„å¤æ‚æ‚¬æµ®æ•ˆæœï¼Œæå‡æ€§èƒ½ */
.punk-tool-card:hover {
    /* ç®€åŒ–çš„æ‚¬æµ®æ•ˆæœï¼Œç§»é™¤å¤æ‚çš„3Då˜æ¢å’ŒåŠ¨ç”» */
    transform: translateY(-2px) translateZ(0) !important;
    box-shadow: 0 4px 15px rgba(255, 0, 128, 0.2) !important;
    background: linear-gradient(135deg, 
        rgba(255, 0, 128, 0.15), 
        rgba(255, 107, 157, 0.15)) !important;
    border-color: rgba(255, 0, 128, 0.4) !important;
}

.punk-tool-card:hover .punk-tool-icon {
    /* ç§»é™¤å¤æ‚çš„åŠ¨ç”»ï¼Œåªä¿ç•™ç®€å•çš„é¢œè‰²å˜åŒ– */
    animation: none !important;
    filter: drop-shadow(0 0 15px var(--punk-secondary)) !important;
    transform: scale(1.05) translateZ(0) !important;
}

.punk-tool-card:hover .punk-tool-title {
    /* ç®€åŒ–æ ‡é¢˜æ‚¬æµ®æ•ˆæœ */
    text-shadow: 0 0 10px var(--punk-secondary) !important;
    transform: scale(1.02) translateZ(0) !important;
}

/* è¦†ç›–å…¶ä»–ä¸»é¢˜çš„å¤æ‚æ‚¬æµ®æ•ˆæœ */
.geek-tool-card:hover .geek-tool-icon,
.rage-tool-card:hover .rage-tool-icon,
.emo-tool-card:hover .emo-tool-icon {
    animation: none !important;
    transform: scale(1.05) translateZ(0) !important;
}

/* è¦†ç›–rage.cssä¸­çš„å¤æ‚æ‚¬æµ®æ•ˆæœ */
.rage-tool-card:hover {
    transform: translateY(-2px) translateZ(0) !important;
    box-shadow: 0 4px 15px rgba(255, 68, 68, 0.2) !important;
}

.rage-tool-card:hover::before {
    opacity: 0 !important;
    animation: none !important;
}

/* è¦†ç›–emo.cssä¸­çš„å¤æ‚æ‚¬æµ®æ•ˆæœ */
.emo-tool-card:hover {
    transform: translateY(-2px) translateZ(0) !important;
    box-shadow: 0 4px 15px rgba(156, 39, 176, 0.2) !important;
}

.emo-tool-card:hover::before {
    left: -100% !important;
    animation: none !important;
}

/* ä¼˜åŒ–will-changeå±æ€§ï¼Œå‡å°‘å†…å­˜å ç”¨ */
.tool-card {
    will-change: transform, box-shadow;
}

.tool-card:hover {
    will-change: transform, box-shadow;
}

/* ç§»é™¤ä¸å¿…è¦çš„åŠ¨ç”»ï¼Œæå‡æ€§èƒ½ */
@media (prefers-reduced-motion: reduce) {
    .punk-tool-card:hover,
    .geek-tool-card:hover,
    .rage-tool-card:hover,
    .emo-tool-card:hover {
        transform: none !important;
        animation: none !important;
    }
    
    .punk-tool-card:hover .punk-tool-icon,
    .geek-tool-card:hover .geek-tool-icon,
    .rage-tool-card:hover .rage-tool-icon,
    .emo-tool-card:hover .emo-tool-icon {
        animation: none !important;
        transform: none !important;
    }
}

/* æ€§èƒ½ä¼˜åŒ–ï¼šå‡å°‘é‡ç»˜å’Œå›æµ */
.tool-card,
.geek-tool-card,
.punk-tool-card,
.rage-tool-card,
.emo-tool-card {
    /* ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½ */
    contain: layout style paint;
    /* é˜²æ­¢å¸ƒå±€æŠ–åŠ¨ */
    transform: translateZ(0);
    /* ä¼˜åŒ–å­—ä½“æ¸²æŸ“ */
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* ç¦ç”¨å¤æ‚çš„CSSåŠ¨ç”»ï¼Œæå‡æ€§èƒ½ */
.punk-tool-icon,
.geek-tool-icon,
.rage-tool-icon,
.emo-tool-icon {
    animation: none !important;
}

/* ç®€åŒ–æ‰€æœ‰å·¥å…·å¡ç‰‡çš„æ‚¬æµ®æ•ˆæœ */
.tool-card:hover,
.geek-tool-card:hover,
.punk-tool-card:hover,
.rage-tool-card:hover,
.emo-tool-card:hover {
    /* ç»Ÿä¸€çš„ç®€åŒ–æ‚¬æµ®æ•ˆæœ */
    transform: translateY(-2px) translateZ(0) !important;
    transition: transform 0.2s ease, box-shadow 0.2s ease !important;
}





/* ä¼˜åŒ–çš„ç€‘å¸ƒæµå¸ƒå±€æ ·å¼ (ç”Ÿæ´»æ¨¡å¼) */
.punk-masonry-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 2rem;
    margin-top: 2rem;
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
    will-change: transform;
}

.masonry-large {
    grid-column: span 2;
}

.masonry-medium {
    grid-column: span 1;
}

.masonry-small {
    grid-column: span 1;
}

/* ç»Ÿä¸€çš„ç½‘æ ¼å¸ƒå±€æ ·å¼ */
.geek-matrix-grid,
.rage-hexagon-grid,
.emo-waterfall-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    margin-top: 2rem;
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
    will-change: transform;
}

/* ç”Ÿæ´»æ¨¡å¼ä¸“ç”¨ç½‘æ ¼å¸ƒå±€ */
.punk-masonry-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 2.5rem;
    margin-top: 2rem;
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
    will-change: transform;
}

/* å·¥å…·å¡ç‰‡åŸºç¡€æ ·å¼ä¼˜åŒ– */
.tool-card {
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
    will-change: background-color, border-color;
    /* é˜²æ­¢é‡ç»˜ä¼˜åŒ– */
    backface-visibility: hidden;
    perspective: 1000px;
    /* é˜²æ­¢å¸ƒå±€æŠ–åŠ¨ */
    contain: layout style paint;
    /* ä¼˜åŒ–è¿‡æ¸¡æ•ˆæœ */
    transition: background-color 0.15s ease, border-color 0.15s ease;
}

.tool-card:hover {
    /* ç§»é™¤å¤æ‚çš„å˜æ¢ï¼Œåªæ”¹å˜é¢œè‰² */
    background-color: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.4);
}

/* å„æ¨¡å¼å·¥å…·å¡ç‰‡ä¸“ç”¨æ ·å¼ */
.geek-tool-card {
    background: linear-gradient(135deg, rgba(0, 255, 231, 0.1), rgba(0, 191, 255, 0.1));
    border: 1px solid rgba(0, 255, 231, 0.3);
    border-radius: 12px;
    padding: 1.5rem;
    transition: background-color 0.2s ease, border-color 0.2s ease;
    font-family: 'Courier New', 'Monaco', 'Menlo', monospace;
}

.geek-tool-card:hover {
    background: linear-gradient(135deg, rgba(0, 255, 231, 0.15), rgba(0, 191, 255, 0.15));
    border-color: rgba(0, 255, 231, 0.4);
}

.punk-tool-card {
    background: linear-gradient(135deg, rgba(255, 0, 128, 0.1), rgba(255, 107, 157, 0.1));
    border: 2px solid rgba(255, 0, 128, 0.3);
    border-radius: 20px;
    padding: 1.5rem;
    transition: background-color 0.2s ease, border-color 0.2s ease;
    font-family: 'Segoe UI', 'Arial', 'Helvetica', sans-serif;
    font-weight: 500;
    letter-spacing: 0.3px;
}

.punk-tool-card:hover {
    background: linear-gradient(135deg, rgba(255, 0, 128, 0.15), rgba(255, 107, 157, 0.15));
    border-color: rgba(255, 0, 128, 0.4);
}

.rage-tool-card {
    background: linear-gradient(135deg, rgba(255, 68, 68, 0.1), rgba(255, 107, 107, 0.1));
    border: 3px solid rgba(255, 68, 68, 0.3);
    border-radius: 15px;
    padding: 1.5rem;
    transition: background-color 0.2s ease, border-color 0.2s ease;
    font-family: 'Segoe UI', 'Arial', 'Helvetica', sans-serif;
    font-weight: 600;
    letter-spacing: 0.3px;
}

.rage-tool-card:hover {
    background: linear-gradient(135deg, rgba(255, 68, 68, 0.15), rgba(255, 107, 107, 0.15));
    border-color: rgba(255, 68, 68, 0.4);
}

.emo-tool-card {
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
    border: 2px solid rgba(102, 126, 234, 0.3);
    border-radius: 25px;
    padding: 1.5rem;
    transition: background-color 0.2s ease, border-color 0.2s ease;
    font-family: 'Segoe UI', 'Arial', 'Helvetica', sans-serif;
    font-weight: 500;
    letter-spacing: 0.3px;
}

.emo-tool-card:hover {
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.15), rgba(118, 75, 162, 0.15));
    border-color: rgba(102, 126, 234, 0.4);
}

/* å„æ¨¡å¼çš„terminalæ ·å¼ */
.geek-terminal {
    background: linear-gradient(135deg, #0d1117 0%, #161b22 100%);
    color: #00ffe7;
    font-family: 'Courier New', 'Monaco', 'Menlo', monospace;
    padding: 1.5rem 2rem;
    border-radius: 12px;
    margin: 1.5rem 0;
    font-size: 1.1rem;
    position: relative;
    border: 1px solid rgba(0,255,231,0.2);
    box-shadow: inset 0 2px 8px rgba(0,0,0,0.3);
    text-align: center;
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
}

.geek-terminal::before {
    content: '$ ';
    color: #00ffe7;
    font-weight: bold;
    animation: blink 1.2s steps(1) infinite;
}

.geek-terminal::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, #00ffe7, #00bfff);
    animation: geekScan 3s ease-in-out infinite;
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
    will-change: transform;
}

.punk-terminal {
    background: linear-gradient(135deg, #ff0080 0%, #ff6b9d 100%);
    color: white;
    font-family: 'Segoe UI', 'Arial', 'Helvetica', sans-serif;
    padding: 1.5rem 2rem;
    border-radius: 20px;
    margin: 1.5rem 0;
    font-size: 1.1rem;
    position: relative;
    border: 2px solid rgba(255,255,255,0.3);
    box-shadow: 0 8px 25px rgba(255,0,128,0.3);
    text-align: center;
    text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    font-weight: 500;
    letter-spacing: 0.5px;
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
}

.punk-terminal::before {
    content: 'ğŸ¨ ';
    font-size: 1.2em;
    margin-right: 8px;
}

.punk-terminal::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, #ff0080, #00ff80);
    /* ç§»é™¤åŠ¨ç”»ï¼Œå‡å°‘å¡é¡¿ */
    /* animation: punkScan 2.5s ease-in-out infinite; */
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
    will-change: transform;
}

.rage-terminal {
    background: linear-gradient(135deg, #ff4444 0%, #ff6b6b 100%);
    color: white;
    font-family: 'Segoe UI', 'Arial', 'Helvetica', sans-serif;
    padding: 1.5rem 2rem;
    border-radius: 15px;
    margin: 1.5rem 0;
    font-size: 1.1rem;
    position: relative;
    border: 3px solid rgba(255,255,255,0.4);
    box-shadow: 0 10px 30px rgba(255,68,68,0.4);
    text-align: center;
    text-shadow: 0 2px 4px rgba(0,0,0,0.5);
    font-weight: 600;
    letter-spacing: 0.5px;
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
}

.rage-terminal::before {
    content: 'ğŸ”¥ ';
    font-size: 1.2em;
    margin-right: 8px;
}

.rage-terminal::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #ff4444, #ffaa44);
    /* ç§»é™¤åŠ¨ç”»ï¼Œå‡å°‘å¡é¡¿ */
    /* animation: rageScan 2s ease-in-out infinite; */
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
    will-change: transform;
}

.emo-terminal {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    font-family: 'Segoe UI', 'Arial', 'Helvetica', sans-serif;
    padding: 1.5rem 2rem;
    border-radius: 25px;
    margin: 1.5rem 0;
    font-size: 1.1rem;
    position: relative;
    border: 2px solid rgba(255,255,255,0.3);
    box-shadow: 0 8px 25px rgba(102,126,234,0.3);
    text-align: center;
    text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    font-weight: 500;
    letter-spacing: 0.5px;
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
}

.emo-terminal::before {
    content: 'ğŸ’” ';
    font-size: 1.2em;
    margin-right: 8px;
}

.emo-terminal::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, #667eea, #f093fb);
    /* ç§»é™¤åŠ¨ç”»ï¼Œå‡å°‘å¡é¡¿ */
    /* animation: emoScan 3.5s ease-in-out infinite; */
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
    will-change: transform;
}

/* åŠ¨ç”»æ•ˆæœ */
@keyframes geekScan {
    0% { transform: translateX(-100%) translateZ(0); }
    100% { transform: translateX(100%) translateZ(0); }
}

@keyframes punkScan {
    0% { transform: translateX(-100%) translateZ(0); }
    100% { transform: translateX(100%) translateZ(0); }
}

@keyframes rageScan {
    0% { transform: translateX(-100%) translateZ(0); }
    100% { transform: translateX(100%) translateZ(0); }
}

@keyframes emoScan {
    0% { transform: translateX(-100%) translateZ(0); }
    100% { transform: translateX(100%) translateZ(0); }
}

@keyframes blink {
    50% { opacity: 0.2; }
}

/* å“åº”å¼è®¾è®¡ - ç”µè„‘è®¾å¤‡ */
@media (min-width: 1024px) {
    .geek-terminal,
    .punk-terminal,
    .rage-terminal,
    .emo-terminal {
        padding: 2rem 3rem;
        font-size: 1.3rem;
        margin: 2rem 0;
    }
    
    .geek-matrix-grid,
    .rage-hexagon-grid,
    .emo-waterfall-grid {
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 2rem;
        margin-top: 3rem;
    }
    
    .punk-masonry-grid {
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 3rem;
        margin-top: 3rem;
    }
}

/* å“åº”å¼è®¾è®¡ - å¹³æ¿è®¾å¤‡ */
@media (min-width: 768px) and (max-width: 1023px) {
    .geek-terminal,
    .punk-terminal,
    .rage-terminal,
    .emo-terminal {
        padding: 1.8rem 2.5rem;
        font-size: 1.2rem;
        margin: 1.8rem 0;
    }
    
    .geek-matrix-grid,
    .rage-hexagon-grid,
    .emo-waterfall-grid {
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        gap: 1.8rem;
        margin-top: 2.5rem;
    }
    
    .punk-masonry-grid {
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        gap: 2.5rem;
        margin-top: 2.5rem;
    }
}

/* å“åº”å¼è®¾è®¡ - ç§»åŠ¨è®¾å¤‡ */
@media (max-width: 767px) {
    .geek-terminal,
    .punk-terminal,
    .rage-terminal,
    .emo-terminal {
        padding: 1.2rem 1.5rem;
        font-size: 1rem;
        margin: 1.2rem 0;
        border-radius: 10px;
    }
    
    .geek-matrix-grid,
    .rage-hexagon-grid,
    .emo-waterfall-grid {
        grid-template-columns: 1fr;
        gap: 1.2rem;
        margin-top: 2rem;
        padding: 0 10px;
    }
    
    .punk-masonry-grid {
        grid-template-columns: 1fr;
        gap: 2rem;
        margin-top: 2rem;
        padding: 0 15px;
    }
    
    .geek-title {
        font-size: 1.8rem;
        padding: 1.5rem;
    }
}

/* å“åº”å¼è®¾è®¡ - å°å±ç§»åŠ¨è®¾å¤‡ */
@media (max-width: 480px) {
    .geek-terminal,
    .punk-terminal,
    .rage-terminal,
    .emo-terminal {
        padding: 1rem 1.2rem;
        font-size: 0.95rem;
        margin: 1rem 0;
    }
    
    .geek-matrix-grid,
    .rage-hexagon-grid,
    .emo-waterfall-grid {
        gap: 1rem;
        margin-top: 1.5rem;
        padding: 0 5px;
    }
    
    .punk-masonry-grid {
        gap: 1.5rem;
        margin-top: 1.5rem;
        padding: 0 10px;
    }
    
    .geek-title {
        font-size: 1.6rem;
        padding: 1.2rem;
    }
}

/* å‡å°‘åŠ¨ç”» - ä¸ºåå¥½å‡å°‘åŠ¨ç”»çš„ç”¨æˆ· */
@media (prefers-reduced-motion: reduce) {
    .geek-terminal::after,
    .punk-terminal::after,
    .rage-terminal::after,
    .emo-terminal::after {
        animation: none;
    }
    
    .geek-terminal::before {
        animation: none;
    }
}

/* æ€§èƒ½ä¼˜åŒ– - å‡å°‘é‡ç»˜å’Œé‡æ’ */
* {
    box-sizing: border-box;
}

.tool-card,
.mode-btn,
.geek-terminal,
.punk-terminal,
.rage-terminal,
.emo-terminal {
    /* ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½ */
    contain: layout style paint;
    /* é˜²æ­¢å¸ƒå±€æŠ–åŠ¨ */
    transform: translateZ(0);
    /* ä¼˜åŒ–å­—ä½“æ¸²æŸ“ */
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* é˜²æ­¢é¡µé¢æŠ–åŠ¨å’Œé—ªçƒ */
#tool-container {
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
    will-change: opacity, transform;
    /* é˜²æ­¢é‡ç»˜ä¼˜åŒ– */
    backface-visibility: hidden;
    perspective: 1000px;
    /* ä¼˜åŒ–åˆæˆå±‚ */
    contain: layout style paint;
    /* å…¨å±å¸ƒå±€ */
    width: 100%;
    max-width: 100%;
    margin: 0;
    padding: 20px;
    box-sizing: border-box;
}

/* ä¼˜åŒ–å·¥å…·ç½‘æ ¼å®¹å™¨ */
.tool-grid-container {
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
    will-change: transform;
    /* é˜²æ­¢é‡ç»˜ä¼˜åŒ– */
    backface-visibility: hidden;
    perspective: 1000px;
    /* é˜²æ­¢å¸ƒå±€æŠ–åŠ¨ */
    contain: layout style paint;
}

/* é˜²æ­¢æŒ‰é’®ç‚¹å‡»æ—¶çš„æŠ–åŠ¨ - å·²ç§»é™¤æ¨¡å¼åˆ‡æ¢æŒ‰é’® */

/* ä¼˜åŒ–åŠ¨ç”»æ€§èƒ½ */
@media (prefers-reduced-motion: reduce) {
    .tool-card,
    #tool-container {
        transition: none !important;
        animation: none !important;
    }
}

/* ä¼˜åŒ–çš„å…­è¾¹å½¢å¸ƒå±€æ ·å¼ (ç‹‚æš´æ¨¡å¼) */
.rage-hexagon-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
    margin-top: 2rem;
}

.hexagon-wrapper {
    position: relative;
    background: linear-gradient(45deg, #ff4444, #ff8844);
    border-radius: 15px;
    padding: 1rem;
    transform: perspective(1000px) rotateX(10deg) translateZ(0);
    transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    /* ç¡¬ä»¶åŠ é€Ÿ */
    will-change: transform;
}

.hexagon-wrapper:hover {
    transform: perspective(1000px) rotateX(0deg) scale(1.02) translateZ(0);
}

.hexagon-inner {
    background: rgba(0, 0, 0, 0.8);
    border-radius: 10px;
    padding: 1.5rem;
    text-align: center;
}

.level-indicator {
    position: absolute;
    top: -10px;
    right: -10px;
    background: #ff4444;
    color: white;
    padding: 5px 10px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: bold;
}



/* ä¼˜åŒ–çš„å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
    .punk-masonry-grid {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        grid-auto-rows: 100px;
    }
    
    .masonry-large {
        grid-row: span 2;
        grid-column: span 1;
    }
    
    .matrix-category-grid {
        grid-template-columns: 1fr;
    }
    
    .rage-hexagon-grid {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    }
}

/* æ€§èƒ½ä¼˜åŒ–ï¼šå‡å°‘é‡ç»˜å’Œå›æµ */
.geek-card,
.punk-container,
.rage-container,
.emo-container {
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
    will-change: transform;
    /* é˜²æ­¢é‡ç»˜ä¼˜åŒ– */
    backface-visibility: hidden;
    perspective: 1000px;
    /* ä¼˜åŒ–åˆæˆå±‚ */
    contain: layout style paint;
}

/* ä¼˜åŒ–å­—ä½“æ¸²æŸ“ */
.geek-title,
.punk-title,
.rage-title,
.emo-title {
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
    /* ä¼˜åŒ–å­—ä½“æ¸²æŸ“ */
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* ä¼˜åŒ–çš„åŠ¨ç”»æ€§èƒ½ */
.tool-card-enter {
    opacity: 0;
    transform: translateY(20px) scale(0.95) translateZ(0);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.tool-card-enter-active {
    opacity: 1;
    transform: translateY(0) scale(1) translateZ(0);
}

.tool-card-exit {
    opacity: 1;
    transform: translateY(0) scale(1) translateZ(0);
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.tool-card-exit-active {
    opacity: 0;
    transform: translateY(-20px) scale(0.95) translateZ(0);
}

/* å‡å°‘é‡ç»˜çš„ä¼˜åŒ– */
.tool-grid-container {
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
    will-change: transform;
    /* é˜²æ­¢é‡ç»˜ä¼˜åŒ– */
    backface-visibility: hidden;
    perspective: 1000px;
}

/* ä¼˜åŒ–æ‚¬åœæ•ˆæœ */
.tool-card {
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
    will-change: transform, box-shadow;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    /* é˜²æ­¢é‡ç»˜ä¼˜åŒ– */
    backface-visibility: hidden;
    perspective: 1000px;
}

.tool-card:hover {
    /* ç®€åŒ–çš„æ‚¬æµ®æ•ˆæœï¼Œå‡å°‘æ€§èƒ½æ¶ˆè€— */
    transform: translateY(-2px) translateZ(0);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

/* æ€§èƒ½ä¼˜åŒ–ï¼šå‡å°‘ä¸å¿…è¦çš„åŠ¨ç”» */
@media (prefers-reduced-motion: reduce) {
    .tool-card,
    .matrix-category,
    .hexagon-wrapper {
        transition: none !important;
        animation: none !important;
    }
}

/* ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½ */
.geek-tool-card,
.punk-tool-card,
.rage-tool-card,
.emo-tool-card {
    /* ç¡¬ä»¶åŠ é€Ÿ */
    transform: translateZ(0);
    will-change: transform, box-shadow;
    /* é˜²æ­¢é‡ç»˜ä¼˜åŒ– */
    backface-visibility: hidden;
    perspective: 1000px;
    /* ä¼˜åŒ–åˆæˆå±‚ */
    contain: layout style paint;
}
</style>

<script>
// èƒŒæ™¯éŸ³ä¹é…ç½®
const musicConfig = {
    life: '{% static "audio/saturday.mp3" %}',     // å‘¨å…­è½»æ¾éŸ³ä¹ - æœ‹å…‹ç”Ÿæ´»
    work: '{% static "audio/tuesday.mp3" %}',     // å‘¨äºŒä¸“æ³¨éŸ³ä¹ - æå®¢å·¥ä½œ  
    training: '{% static "audio/monday.mp3" %}',  // å‘¨ä¸€æ¿€æ˜‚éŸ³ä¹ - ç‹‚æš´è®­ç»ƒ
    emo: '{% static "audio/thursday.mp3" %}'      // å‘¨å››æƒ…æ„ŸéŸ³ä¹ - Emoç–—æ„ˆ
};

// å·¥å…·é…ç½®æ•°æ®
const toolConfigs = {
    life: {
        title: 'ğŸ¨ ç”Ÿæ´»åˆ›æ„å·¥ä½œå®¤',
        subtitle: 'è¿‡äº†ä¸€ç™¾ç§ç”Ÿæ´»æˆ‘æ‰èƒ½çœ‹æ˜ç™½',
        containerClass: 'punk-container',
        titleClass: 'punk-title',
        subtitleClass: 'punk-subtitle',
        terminalClass: 'punk-terminal',
        gridClass: 'punk-masonry-grid',
        cardClass: 'punk-tool-card',
        iconClass: 'punk-tool-icon',
        titleCardClass: 'punk-tool-title',
        descClass: 'punk-tool-desc',
        layoutStyle: 'masonry',
        tools: [
            {
                url: '{% url "life_diary" %}',
                icon: 'fas fa-book-open',
                title: 'ç”Ÿæ´»æ—¥è®°æœ¬',
                desc: 'è®°å½•ç¾å¥½æ—¶å…‰ï¼Œçè—ç”Ÿæ´»ç‚¹æ»´',
                size: 'large'
            },
            {
                url: '{% url "creative_writer" %}',
                icon: 'fas fa-brain',
                title: 'AIè‡ªæˆ‘è®¤çŸ¥åŠ©æ‰‹',
                desc: 'ä¸AIæ·±åº¦äº¤æµï¼Œè·å¾—è‡ªæˆ‘è¯´æ˜ä¹¦',
                size: 'medium'
            },
            {
                url: '{% url "redbook_generator" %}',
                icon: 'fas fa-feather-alt',
                title: 'åˆ›æ„æ–‡æ¡ˆç”Ÿæˆå™¨',
                desc: 'ç”Ÿæ´»åŒ–æ–‡æ¡ˆåˆ›ä½œï¼Œæ¸©æš–è¡¨è¾¾',
                size: 'medium'
            },
            {
                url: '{% url "storyboard" %}',
                icon: 'fas fa-film',
                title: 'æ•…äº‹æ¿åˆ›ä½œ',
                desc: 'ç”¨æ•…äº‹è®°å½•ç”Ÿæ´»ï¼Œç”¨åˆ›æ„ç‚¹äº®æ—¥å¸¸',
                size: 'medium'
            },
            {
                url: '{% url "fortune_analyzer" %}',
                icon: 'fas fa-heart',
                title: 'æƒ…ç¼˜è§£ç å™¨',
                desc: 'æ¢ç´¢å†…å¿ƒï¼Œå¯»æ‰¾çœŸçˆ±',
                size: 'medium'
            },
            {
                url: '{% url "self_analysis" %}',
                icon: 'fas fa-user-astronaut',
                title: 'äººç”Ÿç™¾æ€é•œ',
                desc: 'AIæ·±åº¦å¯¹è¯ï¼Œç…§è§çœŸå®çš„è‡ªå·±',
                size: 'medium'
            }
        ]
    },
    work: {
        title: 'âš¡ ä¸“ä¸šæ•ˆç‡ä¸­å¿ƒ',
        subtitle: 'å›å­ç”Ÿéå¼‚ä¹Ÿï¼Œå–„å‡äºç‰©ä¹Ÿã€‚',
        containerClass: 'geek-card',
        titleClass: 'geek-title',
        subtitleClass: 'geek-subtitle',
        terminalClass: 'geek-terminal',
        gridClass: 'geek-matrix-grid',
        cardClass: 'geek-tool-card',
        iconClass: 'geek-tool-icon',
        titleCardClass: 'geek-tool-title',
        descClass: 'geek-tool-desc',
        layoutStyle: 'matrix',
        tools: [
            {
                url: '{% url "test_case_generator" %}',
                icon: 'fas fa-robot',
                title: 'AIæµ‹è¯•ç”Ÿæˆå™¨',
                desc: 'æ™ºèƒ½åŒ–æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ',
                category: 'ai'
            },
            {
                url: '{% url "pdf_converter" %}',
                icon: 'fas fa-file-code',
                title: 'PDFå¤„ç†å¼•æ“',
                desc: 'é«˜æ•ˆæ–‡æ¡£è½¬æ¢ç³»ç»Ÿ',
                category: 'tools'
            },
            {
                url: '{% url "web_crawler" %}',
                icon: 'fas fa-spider',
                title: 'æ•°æ®çˆ¬è™«å·¥å…·',
                desc: 'æ™ºèƒ½ç½‘ç»œæ•°æ®é‡‡é›†',
                category: 'data'
            }
        ]
    },
    training: {
        title: 'ğŸ”¥ æé™è®­ç»ƒåœº',
        subtitle: 'çªç ´æé™ï¼Œé‡Šæ”¾æ½œèƒ½',
        containerClass: 'rage-container',
        titleClass: 'rage-title',
        subtitleClass: 'rage-subtitle',
        terminalClass: 'rage-terminal',
        gridClass: 'rage-hexagon-grid',
        cardClass: 'rage-tool-card',
        iconClass: 'rage-tool-icon',
        titleCardClass: 'rage-tool-title',
        descClass: 'rage-tool-desc',
        layoutStyle: 'hexagon',
        tools: [
            {
                url: '/fitness/',
                icon: 'fas fa-dumbbell',
                title: 'å¥èº«ä¸­å¿ƒ',
                desc: 'é‡Šæ”¾é‡æ€§åŠ›é‡',
                level: 'expert'
            }
        ]
    },
    emo: {
        title: 'ğŸ’” æƒ…æ„Ÿç–—æ„ˆç©ºé—´',
                        subtitle: 'å¥¹è¯´éš¾è¿‡å¥½è¿‡æ²¡æ„Ÿæƒ…',
        containerClass: 'emo-container',
        titleClass: 'emo-title',
        subtitleClass: 'emo-subtitle',
        terminalClass: 'emo-terminal',
        gridClass: 'emo-grid',
        cardClass: 'emo-tool-card',
        iconClass: 'emo-tool-icon',
        titleCardClass: 'emo-tool-title',
        descClass: 'emo-tool-desc',
        layoutStyle: 'emo',
        tools: [
            {
                url: '{% url "storyboard" %}',
                icon: 'fas fa-film',
                title: 'æ•…äº‹æ¿',
                desc: 'ç”¨æ•…äº‹æ²»æ„ˆå¿ƒçµ',
                mood: 'contemplative'
            }
        ]
    }
};

let currentMode = 'work';
let isPlaying = true;

// é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', async function() {
    
    // è·å–ç”¨æˆ·å½“å‰ä¸»é¢˜
    try {
        const response = await fetch('/users/theme/', {
            headers: {
                'X-CSRFToken': getCookie('csrftoken')
            }
        });
        
        if (response.ok) {
            const data = await response.json();
            if (data.success) {
                currentMode = data.data.mode || 'work';
            }
        }
    } catch (error) {
        console.log('Failed to load user theme:', error);
    }
    
    // åº”ç”¨ä¸»é¢˜
    applyTheme(currentMode);
    updateActiveButton(currentMode);
    renderTools(currentMode);
    updateMusic(currentMode);
});

// CSSé¢„åŠ è½½å·²ç§»é™¤ï¼Œä½¿ç”¨ç›´æ¥åˆ‡æ¢æ–¹å¼

// ç›‘å¬å¯¼èˆªèœå•ä¸­çš„ä¸»é¢˜åˆ‡æ¢äº‹ä»¶
document.addEventListener('click', function(e) {
    const themeSwitch = e.target.closest('.theme-switch');
    if (themeSwitch) {
        e.preventDefault(); // é˜»æ­¢é»˜è®¤çš„é“¾æ¥è¡Œä¸º
        const mode = themeSwitch.dataset.mode;
        
        if (mode !== currentMode) {
            // ç›´æ¥è°ƒç”¨åˆ‡æ¢å‡½æ•°
            switchMode(mode);
        }
    }
});

// æ— æŠ–åŠ¨æ¨¡å¼åˆ‡æ¢å‡½æ•°
function switchMode(mode) {
    if (mode === currentMode) return;
    
    // ä½¿ç”¨ requestAnimationFrame ç¡®ä¿åœ¨ä¸‹ä¸€å¸§æ‰§è¡Œï¼Œé¿å…å¸ƒå±€æŠ–åŠ¨
    requestAnimationFrame(() => {
        // æ‰¹é‡æ›´æ–°ï¼Œå‡å°‘é‡æ’
        const updates = () => {
            currentMode = mode;
            updateActiveButton(mode);
            applyTheme(mode);
            renderTools(mode);
            updateMusic(mode);
        };
        
        // ç«‹å³æ‰§è¡Œæ›´æ–°
        updates();
        
        // å¼‚æ­¥æ›´æ–°åç«¯ï¼Œä¸é˜»å¡UI
        fetch('/users/theme/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken')
            },
            body: JSON.stringify({ mode: mode })
        }).catch(error => {
            console.log('Failed to update theme:', error);
        });
    });
}

// æ— æŠ–åŠ¨ä¸»é¢˜åº”ç”¨å‡½æ•°
function applyTheme(mode) {
    // ä½¿ç”¨ requestAnimationFrame ç¡®ä¿æµç•…çš„æ ·å¼åˆ‡æ¢
    requestAnimationFrame(() => {
        // ç›´æ¥æ›´æ–°bodyç±»åï¼Œæ‰€æœ‰CSSæ–‡ä»¶å·²é¢„åŠ è½½
        document.body.className = mode + '-theme';
    });
}

// æ— æŠ–åŠ¨æ›´æ–°æ¿€æ´»æŒ‰é’®
function updateActiveButton(mode) {
    // ä½¿ç”¨ requestAnimationFrame ç¡®ä¿æµç•…çš„æŒ‰é’®çŠ¶æ€æ›´æ–°
    requestAnimationFrame(() => {
        // æ›´æ–°å¯¼èˆªèœå•ä¸­çš„ä¸»é¢˜åˆ‡æ¢æŒ‰é’®çŠ¶æ€
        document.querySelectorAll('.theme-switch').forEach(btn => {
            btn.classList.remove('active');
        });
        
        const activeBtn = document.querySelector(`.theme-switch[data-mode="${mode}"]`);
        if (activeBtn) {
            activeBtn.classList.add('active');
        }
    });
}

// æ— æŠ–åŠ¨æ¸²æŸ“å·¥å…·å¡ç‰‡å‡½æ•°
function renderTools(mode) {
    const config = toolConfigs[mode];
    const container = document.getElementById('tool-container');
    const title = document.getElementById('tool-title');
    const grid = document.getElementById('tool-grid');
    
    if (!container || !title || !grid) {
        console.error('Required elements not found');
        return;
    }
    
    // ä½¿ç”¨ requestAnimationFrame ç¡®ä¿æµç•…çš„DOMæ›´æ–°
    requestAnimationFrame(() => {
        // æ‰¹é‡æ›´æ–°ï¼Œå‡å°‘é‡æ’
        const batchUpdate = () => {
            // éšè—æ‰€æœ‰terminal div
            const allTerminals = ['tool-terminal', 'life-terminal', 'training-terminal', 'emo-terminal'];
            allTerminals.forEach(id => {
                const terminal = document.getElementById(id);
                if (terminal) {
                    terminal.style.display = 'none';
                    terminal.textContent = '';
                }
            });
            
            // æ˜¾ç¤ºå½“å‰æ¨¡å¼çš„terminal div
            const currentTerminalId = mode === 'work' ? 'tool-terminal' : `${mode}-terminal`;
            const currentTerminal = document.getElementById(currentTerminalId);
            
            if (currentTerminal) {
                currentTerminal.style.display = 'block';
                currentTerminal.textContent = config.subtitle;
            }
            
            // æ‰¹é‡æ›´æ–°æ ·å¼ç±»
            container.className = config.containerClass;
            title.className = config.titleClass;
            grid.className = config.gridClass + ' tool-grid-container';
            
            // æ›´æ–°æ ‡é¢˜
            title.innerHTML = config.title;
            
            // æ›´æ–°å³ä¸Šè§’çš„æ¨¡å¼æ˜¾ç¤º
            updateThemeBadge(mode);
        };
        
        // æ‰§è¡Œæ‰¹é‡æ›´æ–°
        batchUpdate();
        
        // ä½¿ç”¨ DocumentFragment ä¼˜åŒ–DOMæ“ä½œ
        const fragment = document.createDocumentFragment();
        
        // é¢„æ„å»ºæ‰€æœ‰å·¥å…·å¡ç‰‡
        config.tools.forEach(tool => {
            const toolLink = document.createElement('a');
            toolLink.href = tool.url;
            toolLink.className = `${config.cardClass} tool-card`;
            
            const iconDiv = document.createElement('div');
            iconDiv.className = config.iconClass;
            iconDiv.innerHTML = `<i class="${tool.icon}"></i>`;
            
            const titleDiv = document.createElement('div');
            titleDiv.className = config.titleCardClass;
            titleDiv.textContent = tool.title;
            
            const descDiv = document.createElement('div');
            descDiv.className = config.descClass;
            descDiv.textContent = tool.desc;
            
            toolLink.appendChild(iconDiv);
            toolLink.appendChild(titleDiv);
            toolLink.appendChild(descDiv);
            
            fragment.appendChild(toolLink);
        });
        
        // ä¸€æ¬¡æ€§æ›´æ–°DOM
        grid.innerHTML = '';
        grid.appendChild(fragment);
    });
}

// ä¼˜åŒ–çš„ç€‘å¸ƒæµå¸ƒå±€ (ç”Ÿæ´»æ¨¡å¼)
function renderMasonryLayout(config, container) {
    config.tools.forEach(tool => {
        const sizeClass = tool.size === 'large' ? 'masonry-large' : 
                         tool.size === 'small' ? 'masonry-small' : 'masonry-medium';
        const card = document.createElement('a');
        card.href = tool.url;
        card.className = `${config.cardClass} ${sizeClass} tool-card`;
        card.innerHTML = `
            <div class="${config.iconClass}">
                <i class="${tool.icon}"></i>
            </div>
            <div class="${config.titleCardClass}">${tool.title}</div>
            <div class="${config.descClass}">${tool.desc}</div>
        `;
        container.appendChild(card);
    });
}

// ä¼˜åŒ–çš„çŸ©é˜µå¸ƒå±€ (æå®¢æ¨¡å¼)
function renderMatrixLayout(config, container) {
    // ç›´æ¥æ¸²æŸ“æ‰€æœ‰å·¥å…·ï¼Œä¸åˆ†ç±»
    const toolsFragment = document.createDocumentFragment();
    
    config.tools.forEach(tool => {
        const toolLink = document.createElement('a');
        toolLink.href = tool.url;
        toolLink.className = `${config.cardClass} tool-card`;
        
        const iconDiv = document.createElement('div');
        iconDiv.className = config.iconClass;
        iconDiv.innerHTML = `<i class="${tool.icon}"></i>`;
        
        const titleDiv = document.createElement('div');
        titleDiv.className = config.titleCardClass;
        titleDiv.textContent = tool.title;
        
        const descDiv = document.createElement('div');
        descDiv.className = config.descClass;
        descDiv.textContent = tool.desc;
        
        toolLink.appendChild(iconDiv);
        toolLink.appendChild(titleDiv);
        toolLink.appendChild(descDiv);
        
        toolsFragment.appendChild(toolLink);
    });
    
    container.appendChild(toolsFragment);
}

// ä¼˜åŒ–çš„å…­è¾¹å½¢å¸ƒå±€ (ç‹‚æš´æ¨¡å¼)
function renderHexagonLayout(config, container) {
    config.tools.forEach(tool => {
        const card = document.createElement('a');
        card.href = tool.url;
        card.className = `${config.cardClass} tool-card`;
        card.innerHTML = `
            <div class="hexagon-wrapper">
                <div class="hexagon-inner">
                    <div class="${config.iconClass}">
                        <i class="${tool.icon}"></i>
                    </div>
                    <div class="${config.titleCardClass}">${tool.title}</div>
                    <div class="${config.descClass}">${tool.desc}</div>
                </div>
            </div>
        `;
        container.appendChild(card);
    });
}

// ä¼˜åŒ–çš„Emoå¸ƒå±€ (æƒ…æ„Ÿæ¨¡å¼)
function renderEmoLayout(config, container) {
    config.tools.forEach(tool => {
        const moodClass = `mood-${tool.mood || 'emotional'}`;
        const card = document.createElement('a');
        card.href = tool.url;
        card.className = `${config.cardClass} tool-card`;
        card.innerHTML = `
            <div class="${config.iconClass}">
                <i class="${tool.icon}"></i>
            </div>
            <div class="${config.titleCardClass}">${tool.title}</div>
            <div class="${config.descClass}">${tool.desc}</div>
            <div class="emo-mood-tag ${moodClass}">${getMoodName(tool.mood)}</div>
        `;
        container.appendChild(card);
    });
}

// ä¼˜åŒ–çš„é»˜è®¤å¸ƒå±€
function renderDefaultLayout(config, container) {
    config.tools.forEach(tool => {
        const card = document.createElement('a');
        card.href = tool.url;
        card.className = `${config.cardClass} tool-card`;
        card.innerHTML = `
            <div class="${config.iconClass}">
                <i class="${tool.icon}"></i>
            </div>
            <div class="${config.titleCardClass}">${tool.title}</div>
            <div class="${config.descClass}">${tool.desc}</div>
        `;
        container.appendChild(card);
    });
}

// éŸ³ä¹ç›¸å…³å‡½æ•° - ä½¿ç”¨å…¨å±€éŸ³ä¹ç³»ç»Ÿ
function updateMusic(mode) {
    // ä½¿ç”¨å…¨å±€çš„ setThemeMusic å‡½æ•°
    if (typeof setThemeMusic === 'function') {
        setThemeMusic(mode);
    }
}

// æ›´æ–°ä¸»é¢˜å¾½ç« 
function updateThemeBadge(mode) {
    const themeBadge = document.querySelector('.theme-badge');
    if (themeBadge) {
        // ç§»é™¤æ‰€æœ‰æ¨¡å¼ç±»
        themeBadge.classList.remove('punk', 'geek', 'rage', 'emo');
        
        // æ·»åŠ å½“å‰æ¨¡å¼ç±»
        const modeMap = {
            'life': 'punk',
            'work': 'geek', 
            'training': 'rage',
            'emo': 'emo'
        };
        
        const badgeClass = modeMap[mode];
        if (badgeClass) {
            themeBadge.classList.add(badgeClass);
        }
        
        // æ›´æ–°å¾½ç« æ–‡æœ¬
        const modeNames = {
            'life': 'ç”Ÿæ´»',
            'work': 'æå®¢',
            'training': 'ç‹‚æš´', 
            'emo': 'Emo'
        };
        
        themeBadge.textContent = modeNames[mode] || mode;
    }
}

// å·¥å…·å‡½æ•°
function getCategoryName(cat) {
    const names = {
        'ai': 'ğŸ¤– AIå·¥å…·',
        'data': 'ğŸ“Š æ•°æ®å¤„ç†', 
        'tools': 'ğŸ”§ å®ç”¨å·¥å…·',
        'other': 'ğŸ“¦ å…¶ä»–'
    };
    return names[cat] || cat;
}



function getMoodName(mood) {
    const names = {
        'melancholy': 'å¿§éƒ',
        'nostalgic': 'æ€€æ—§',
        'contemplative': 'æ²‰æ€',
        'emotional': 'æƒ…æ„Ÿ'
    };
    return names[mood] || 'æƒ…æ„Ÿ';
}

// è·å–CSRF Token
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
</script>
{% endblock %}