{% extends 'base.html' %}
{% load static %}

{% block title %}ç‚¹å‡»æµ‹è¯• - ç‹¬ç«‹ç‰ˆæœ¬{% endblock %}

{% block extra_css %}
<style>
body {
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    margin: 0;
    padding: 20px;
    min-height: 100vh;
    cursor: pointer;
}

.container {
    max-width: 800px;
    margin: 0 auto;
    text-align: center;
    padding: 50px 20px;
}

.title {
    font-size: 2.5rem;
    margin-bottom: 30px;
}

.counter {
    font-size: 3rem;
    margin: 30px 0;
    background: rgba(255, 255, 255, 0.1);
    padding: 20px;
    border-radius: 15px;
    backdrop-filter: blur(10px);
}

.instructions {
    font-size: 1.2rem;
    margin: 20px 0;
    opacity: 0.9;
}

.test-buttons {
    position: fixed;
    top: 10px;
    right: 10px;
    z-index: 1000;
}

.test-btn {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border: none;
    padding: 10px 15px;
    border-radius: 5px;
    cursor: pointer;
    margin-bottom: 5px;
    display: block;
    width: 120px;
    font-size: 12px;
}

.test-btn:hover {
    background: rgba(255, 255, 255, 0.3);
}

.test-btn.red {
    background: rgba(255, 0, 0, 0.2);
}

.test-btn.green {
    background: rgba(0, 255, 0, 0.2);
}

.debug {
    position: fixed;
    top: 10px;
    left: 10px;
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 15px;
    border-radius: 10px;
    font-family: monospace;
    font-size: 12px;
    max-width: 300px;
    max-height: 400px;
    overflow-y: auto;
    z-index: 1000;
}

.success {
    background: rgba(76, 175, 80, 0.3);
    padding: 20px;
    border-radius: 15px;
    margin: 20px 0;
    display: none;
}
</style>
{% endblock %}

{% block content %}
<div class="test-buttons">
    <button class="test-btn" onclick="testClick()">æµ‹è¯•ç‚¹å‡»</button>
    <button class="test-btn red" onclick="simulate4Clicks()">æ¨¡æ‹Ÿ4æ¬¡ç‚¹å‡»</button>
    <button class="test-btn green" onclick="clearDebug()">æ¸…é™¤è°ƒè¯•</button>
</div>

<div class="debug" id="debug">
    è°ƒè¯•ä¿¡æ¯å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...
</div>

<div class="container">
    <h1 class="title">ğŸ’• ç‚¹å‡»æµ‹è¯• - ç‹¬ç«‹ç‰ˆæœ¬</h1>
    
    <div class="counter" id="counter">ç‚¹å‡»æ¬¡æ•°: 0</div>
    
    <div class="instructions">
        åœ¨é¡µé¢ä»»æ„ä½ç½®ç‚¹å‡»4æ¬¡ï¼Œ3ç§’å†…å®Œæˆ<br>
        æˆ–è€…ä½¿ç”¨å³ä¸Šè§’çš„æµ‹è¯•æŒ‰é’®
    </div>
    
    <div class="success" id="success">
        ğŸ‰ æˆåŠŸï¼æ‚¨è§¦å‘äº†4æ¬¡ç‚¹å‡»ï¼
    </div>
</div>

<script>
// å…¨å±€å˜é‡
let clickCount = 0;
let clickTimer = null;

// è°ƒè¯•å‡½æ•°
function log(message) {
    const debug = document.getElementById('debug');
    const timestamp = new Date().toLocaleTimeString();
    debug.innerHTML += `<div>[${timestamp}] ${message}</div>`;
    console.log(message);
}

// ç‚¹å‡»å¤„ç†å‡½æ•°
function handleClick(event) {
    log(`ç‚¹å‡»äº‹ä»¶è§¦å‘ï¼Œç›®æ ‡: ${event.target.tagName}`);
    
    // æ¸…é™¤ä¹‹å‰çš„è®¡æ—¶å™¨
    if (clickTimer) {
        clearTimeout(clickTimer);
        log('æ¸…é™¤ä¹‹å‰çš„è®¡æ—¶å™¨');
    }
    
    // å¢åŠ ç‚¹å‡»è®¡æ•°
    clickCount++;
    document.getElementById('counter').textContent = `ç‚¹å‡»æ¬¡æ•°: ${clickCount}`;
    log(`ç‚¹å‡»è®¡æ•°å¢åŠ åˆ°: ${clickCount}`);
    
    // è®¾ç½®æ–°çš„è®¡æ—¶å™¨ï¼Œ3ç§’åé‡ç½®è®¡æ•°
    clickTimer = setTimeout(() => {
        log('è®¡æ—¶å™¨é‡ç½®ï¼Œè®¡æ•°æ¸…é›¶');
        clickCount = 0;
        document.getElementById('counter').textContent = `ç‚¹å‡»æ¬¡æ•°: ${clickCount}`;
    }, 3000);
    
    // å¦‚æœç‚¹å‡»äº†4æ¬¡ï¼Œæ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
    if (clickCount === 4) {
        log('è§¦å‘4æ¬¡ç‚¹å‡»ï¼');
        clickCount = 0;
        document.getElementById('counter').textContent = `ç‚¹å‡»æ¬¡æ•°: ${clickCount}`;
        document.getElementById('success').style.display = 'block';
        
        // 3ç§’åéšè—æˆåŠŸæ¶ˆæ¯
        setTimeout(() => {
            document.getElementById('success').style.display = 'none';
        }, 3000);
    }
}

// æµ‹è¯•ç‚¹å‡»å‡½æ•°
function testClick() {
    log('æµ‹è¯•ç‚¹å‡»æŒ‰é’®è¢«ç‚¹å‡»');
    alert('æµ‹è¯•ç‚¹å‡»æŒ‰é’®æ­£å¸¸å·¥ä½œï¼');
}

// æ¨¡æ‹Ÿ4æ¬¡ç‚¹å‡»
function simulate4Clicks() {
    log('æ¨¡æ‹Ÿ4æ¬¡ç‚¹å‡»è¢«è°ƒç”¨');
    alert('å¼€å§‹æ¨¡æ‹Ÿ4æ¬¡ç‚¹å‡»...');
    
    for (let i = 0; i < 4; i++) {
        setTimeout(() => {
            handleClick({ target: { tagName: 'BUTTON' } });
        }, i * 100);
    }
}

// æ¸…é™¤è°ƒè¯•ä¿¡æ¯
function clearDebug() {
    document.getElementById('debug').innerHTML = 'è°ƒè¯•ä¿¡æ¯å·²æ¸…é™¤...';
}

// é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
    log('é¡µé¢åŠ è½½å®Œæˆ');
    
    // æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
    document.addEventListener('click', handleClick);
    log('ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨å·²æ·»åŠ ');
    
    // æµ‹è¯•äº‹ä»¶ç›‘å¬å™¨æ˜¯å¦å·¥ä½œ
    setTimeout(() => {
        log('ğŸ’¡ æç¤ºï¼šåœ¨é¡µé¢ä»»æ„ä½ç½®ç‚¹å‡»4æ¬¡å¯ä»¥è§¦å‘åŠŸèƒ½');
    }, 1000);
});

// ç¡®ä¿è„šæœ¬åŠ è½½å®Œæˆ
log('è„šæœ¬å¼€å§‹æ‰§è¡Œ');
</script>
{% endblock %}
