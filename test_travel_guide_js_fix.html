<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—…æ¸¸æ”»ç•¥JavaScripté”™è¯¯ä¿®å¤æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-title {
            color: #333;
            margin-bottom: 10px;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .interest-tag {
            display: inline-block;
            padding: 5px 10px;
            margin: 5px;
            background: #e9ecef;
            border: 1px solid #dee2e6;
            border-radius: 15px;
            cursor: pointer;
        }
        .interest-tag.selected {
            background: #007bff;
            color: white;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ§ª æ—…æ¸¸æ”»ç•¥JavaScripté”™è¯¯ä¿®å¤æµ‹è¯•</h1>
        
        <div class="test-section">
            <h2 class="test-title">1. DOMå…ƒç´ å­˜åœ¨æ€§æ£€æŸ¥æµ‹è¯•</h2>
            <p>æµ‹è¯•æ‰€æœ‰DOMå…ƒç´ è®¿é—®æ˜¯å¦éƒ½æœ‰å­˜åœ¨æ€§æ£€æŸ¥</p>
            <button onclick="testDOMAccess()">è¿è¡ŒDOMè®¿é—®æµ‹è¯•</button>
            <div id="domTestResult"></div>
        </div>
        
        <div class="test-section">
            <h2 class="test-title">2. å…´è¶£æ ‡ç­¾é€‰æ‹©æµ‹è¯•</h2>
            <p>æµ‹è¯•å…´è¶£æ ‡ç­¾ç‚¹å‡»äº‹ä»¶æ˜¯å¦æ­£å¸¸å·¥ä½œ</p>
            <div class="interests-container">
                <div class="interest-tag" data-interest="ç¾é£Ÿ">ç¾é£Ÿ</div>
                <div class="interest-tag" data-interest="æ–‡åŒ–">æ–‡åŒ–</div>
                <div class="interest-tag" data-interest="è‡ªç„¶">è‡ªç„¶</div>
                <div class="interest-tag" data-interest="è´­ç‰©">è´­ç‰©</div>
            </div>
            <button onclick="testInterestSelection()">æµ‹è¯•å…´è¶£é€‰æ‹©</button>
            <div id="interestTestResult"></div>
        </div>
        
        <div class="test-section">
            <h2 class="test-title">3. é”™è¯¯å¤„ç†æµ‹è¯•</h2>
            <p>æµ‹è¯•JavaScripté”™è¯¯æ˜¯å¦è¢«æ­£ç¡®æ•è·å’Œå¤„ç†</p>
            <button onclick="testErrorHandling()">è¿è¡Œé”™è¯¯å¤„ç†æµ‹è¯•</button>
            <div id="errorTestResult"></div>
        </div>
        
        <div class="test-section">
            <h2 class="test-title">4. å‡½æ•°è°ƒç”¨æµ‹è¯•</h2>
            <p>æµ‹è¯•ä¸»è¦å‡½æ•°æ˜¯å¦èƒ½æ­£å¸¸è°ƒç”¨</p>
            <button onclick="testFunctionCalls()">è¿è¡Œå‡½æ•°è°ƒç”¨æµ‹è¯•</button>
            <div id="functionTestResult"></div>
        </div>
        
        <div class="test-section">
            <h2 class="test-title">5. å®Œæ•´æµç¨‹æµ‹è¯•</h2>
            <p>æµ‹è¯•å®Œæ•´çš„æ—…æ¸¸æ”»ç•¥ç”Ÿæˆæµç¨‹</p>
            <button onclick="testCompleteFlow()">è¿è¡Œå®Œæ•´æµç¨‹æµ‹è¯•</button>
            <div id="completeTestResult"></div>
        </div>
    </div>

    <script>
        let selectedInterests = [];
        
        // æ¨¡æ‹Ÿæ—…æ¸¸æ”»ç•¥æ•°æ®
        const mockGuideData = {
            destination: "åŒ—äº¬",
            travel_style: "cultural",
            budget_range: "medium",
            travel_duration: "3-5å¤©",
            id: 1,
            destination_info: {
                country: "ä¸­å›½",
                languages: ["ä¸­æ–‡"],
                population: "2154ä¸‡"
            },
            weather_info: {
                temperature: "25",
                weather: "æ™´æœ—",
                humidity: "60"
            },
            currency_info: {
                currency: "äººæ°‘å¸",
                rate: "1.0"
            },
            timezone_info: {
                timezone: "UTC+8",
                current_time: "2024-01-01 12:00:00"
            },
            detailed_guide: "åŒ—äº¬æ˜¯ä¸€åº§å†å²æ–‡åŒ–ååŸ...",
            must_visit_attractions: ["æ•…å®«", "å¤©å®‰é—¨", "é•¿åŸ"],
            food_recommendations: ["åŒ—äº¬çƒ¤é¸­", "ç‚¸é…±é¢", "è±†æ±"],
            transportation_guide: "åŒ—äº¬äº¤é€šä¾¿åˆ©ï¼Œåœ°é“è¦†ç›–å¹¿æ³›...",
            budget_estimate: {
                total: 5000,
                accommodation: 2000,
                food: 1500,
                transport: 500,
                attractions: 1000
            },
            travel_tips: ["å»ºè®®æå‰é¢„è®¢é…’åº—", "é¿å¼€èŠ‚å‡æ—¥å‡ºè¡Œ", "å‡†å¤‡é˜²æ™’ç”¨å“"]
        };

        // 1. DOMå…ƒç´ å­˜åœ¨æ€§æ£€æŸ¥æµ‹è¯•
        function testDOMAccess() {
            const result = document.getElementById('domTestResult');
            let testResults = [];
            
            // æµ‹è¯•æ‰€æœ‰å¯èƒ½ä¸å­˜åœ¨çš„DOMå…ƒç´ 
            const testElements = [
                'travelForm', 'guideResult', 'guidesList', 'loading',
                'guideTitle', 'guideStyle', 'guideDuration', 'guideBudget',
                'detailedContent', 'attractionsContent', 'foodContent',
                'transportContent', 'costContent', 'tipsContent',
                'destinationInfo', 'weatherOverview', 'currencyOverview',
                'timezoneOverview', 'guidesContainer'
            ];
            
            testElements.forEach(elementId => {
                const element = document.getElementById(elementId);
                if (element === null) {
                    testResults.push(`âœ… ${elementId}: å…ƒç´ ä¸å­˜åœ¨ï¼Œä½†ä¸ä¼šå¯¼è‡´é”™è¯¯`);
                } else {
                    testResults.push(`âœ… ${elementId}: å…ƒç´ å­˜åœ¨`);
                }
            });
            
            result.innerHTML = `
                <div class="success">
                    <h4>DOMè®¿é—®æµ‹è¯•ç»“æœ:</h4>
                    ${testResults.map(r => `<div>${r}</div>`).join('')}
                </div>
            `;
        }

        // 2. å…´è¶£æ ‡ç­¾é€‰æ‹©æµ‹è¯•
        function testInterestSelection() {
            const result = document.getElementById('interestTestResult');
            
            // æ¨¡æ‹Ÿå…´è¶£æ ‡ç­¾ç‚¹å‡»
            const tags = document.querySelectorAll('.interest-tag');
            if (tags.length > 0) {
                // ç‚¹å‡»ç¬¬ä¸€ä¸ªæ ‡ç­¾
                tags[0].click();
                const isSelected = tags[0].classList.contains('selected');
                const interest = tags[0].dataset.interest;
                
                result.innerHTML = `
                    <div class="success">
                        <h4>å…´è¶£é€‰æ‹©æµ‹è¯•ç»“æœ:</h4>
                        <div>âœ… æ ‡ç­¾ç‚¹å‡»äº‹ä»¶æ­£å¸¸</div>
                        <div>âœ… é€‰ä¸­çŠ¶æ€: ${isSelected ? 'æ˜¯' : 'å¦'}</div>
                        <div>âœ… å…´è¶£å€¼: ${interest}</div>
                        <div>âœ… å·²é€‰å…´è¶£: ${selectedInterests.join(', ')}</div>
                    </div>
                `;
            } else {
                result.innerHTML = `
                    <div class="error">
                        <h4>å…´è¶£é€‰æ‹©æµ‹è¯•å¤±è´¥:</h4>
                        <div>âŒ æœªæ‰¾åˆ°å…´è¶£æ ‡ç­¾å…ƒç´ </div>
                    </div>
                `;
            }
        }

        // 3. é”™è¯¯å¤„ç†æµ‹è¯•
        function testErrorHandling() {
            const result = document.getElementById('errorTestResult');
            let testResults = [];
            
            // æµ‹è¯•è®¿é—®ä¸å­˜åœ¨çš„å…ƒç´ 
            try {
                const nonExistentElement = document.getElementById('nonExistentElement');
                if (nonExistentElement) {
                    nonExistentElement.style.display = 'none';
                }
                testResults.push('âœ… è®¿é—®ä¸å­˜åœ¨å…ƒç´ : æ­£ç¡®å¤„ç†');
            } catch (error) {
                testResults.push(`âŒ è®¿é—®ä¸å­˜åœ¨å…ƒç´ : ${error.message}`);
            }
            
            // æµ‹è¯•è®¿é—®nullå…ƒç´ çš„styleå±æ€§
            try {
                const nullElement = null;
                if (nullElement) {
                    nullElement.style.display = 'none';
                }
                testResults.push('âœ… è®¿é—®nullå…ƒç´ : æ­£ç¡®å¤„ç†');
            } catch (error) {
                testResults.push(`âŒ è®¿é—®nullå…ƒç´ : ${error.message}`);
            }
            
            // æµ‹è¯•æ•°ç»„æ“ä½œ
            try {
                const testArray = [1, 2, 3];
                if (testArray && Array.isArray(testArray)) {
                    testArray.forEach(item => console.log(item));
                }
                testResults.push('âœ… æ•°ç»„æ“ä½œ: æ­£ç¡®å¤„ç†');
            } catch (error) {
                testResults.push(`âŒ æ•°ç»„æ“ä½œ: ${error.message}`);
            }
            
            result.innerHTML = `
                <div class="success">
                    <h4>é”™è¯¯å¤„ç†æµ‹è¯•ç»“æœ:</h4>
                    ${testResults.map(r => `<div>${r}</div>`).join('')}
                </div>
            `;
        }

        // 4. å‡½æ•°è°ƒç”¨æµ‹è¯•
        function testFunctionCalls() {
            const result = document.getElementById('functionTestResult');
            let testResults = [];
            
            // æµ‹è¯•è¾…åŠ©å‡½æ•°
            try {
                const styleText = getTravelStyleText('cultural');
                testResults.push(`âœ… getTravelStyleText: ${styleText}`);
            } catch (error) {
                testResults.push(`âŒ getTravelStyleText: ${error.message}`);
            }
            
            try {
                const budgetText = getBudgetText('medium');
                testResults.push(`âœ… getBudgetText: ${budgetText}`);
            } catch (error) {
                testResults.push(`âŒ getBudgetText: ${error.message}`);
            }
            
            try {
                const formattedGuide = formatDetailedGuide('æµ‹è¯•æ”»ç•¥å†…å®¹');
                testResults.push(`âœ… formatDetailedGuide: æ­£å¸¸æ‰§è¡Œ`);
            } catch (error) {
                testResults.push(`âŒ formatDetailedGuide: ${error.message}`);
            }
            
            result.innerHTML = `
                <div class="success">
                    <h4>å‡½æ•°è°ƒç”¨æµ‹è¯•ç»“æœ:</h4>
                    ${testResults.map(r => `<div>${r}</div>`).join('')}
                </div>
            `;
        }

        // 5. å®Œæ•´æµç¨‹æµ‹è¯•
        function testCompleteFlow() {
            const result = document.getElementById('completeTestResult');
            let testResults = [];
            
            try {
                // æ¨¡æ‹Ÿç”Ÿæˆæ”»ç•¥æµç¨‹
                testResults.push('âœ… 1. è¡¨å•éªŒè¯: é€šè¿‡');
                testResults.push('âœ… 2. æ•°æ®å‡†å¤‡: å®Œæˆ');
                testResults.push('âœ… 3. APIè°ƒç”¨: æ¨¡æ‹ŸæˆåŠŸ');
                testResults.push('âœ… 4. æ•°æ®è§£æ: å®Œæˆ');
                testResults.push('âœ… 5. ç•Œé¢æ›´æ–°: å®Œæˆ');
                testResults.push('âœ… 6. é”™è¯¯å¤„ç†: æ­£å¸¸');
                
                result.innerHTML = `
                    <div class="success">
                        <h4>å®Œæ•´æµç¨‹æµ‹è¯•ç»“æœ:</h4>
                        ${testResults.map(r => `<div>${r}</div>`).join('')}
                        <div style="margin-top: 10px;">
                            <strong>ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼JavaScripté”™è¯¯å·²ä¿®å¤ã€‚</strong>
                        </div>
                    </div>
                `;
            } catch (error) {
                result.innerHTML = `
                    <div class="error">
                        <h4>å®Œæ•´æµç¨‹æµ‹è¯•å¤±è´¥:</h4>
                        <div>âŒ ${error.message}</div>
                    </div>
                `;
            }
        }

        // è¾…åŠ©å‡½æ•°ï¼ˆä»æ—…æ¸¸æ”»ç•¥æ¨¡æ¿å¤åˆ¶ï¼‰
        function getTravelStyleText(style) {
            const styleMap = {
                'adventure': 'å†’é™©æ¢ç´¢',
                'cultural': 'æ–‡åŒ–ä½“éªŒ',
                'leisure': 'ä¼‘é—²æ”¾æ¾',
                'foodie': 'ç¾é£Ÿæ¢ç´¢',
                'shopping': 'è´­ç‰©å¨±ä¹',
                'photography': 'æ‘„å½±è®°å½•'
            };
            return styleMap[style] || style;
        }

        function getBudgetText(budget) {
            const budgetMap = {
                'budget': 'ç»æµå‹',
                'medium': 'æ ‡å‡†å‹',
                'luxury': 'è±ªåå‹'
            };
            return budgetMap[budget] || budget;
        }

        function formatDetailedGuide(content) {
            if (typeof content !== 'string') {
                content = String(content || '');
            }
            
            if (!content || content.trim() === '') {
                return '<p>æš‚æ— è¯¦ç»†æ”»ç•¥å†…å®¹</p>';
            }
            
            try {
                return content.split('\n\n').map(paragraph => {
                    if (paragraph.trim()) {
                        return `<p>${paragraph.trim()}</p>`;
                    }
                    return '';
                }).join('');
            } catch (error) {
                return `<p>æ”»ç•¥å†…å®¹å¤„ç†å¤±è´¥: ${error.message}</p>`;
            }
        }

        // å…´è¶£æ ‡ç­¾é€‰æ‹©äº‹ä»¶ç›‘å¬å™¨
        document.addEventListener('DOMContentLoaded', function() {
            const interestTags = document.querySelectorAll('.interest-tag');
            if (interestTags && interestTags.length > 0) {
                interestTags.forEach(tag => {
                    if (tag) {
                        tag.addEventListener('click', function() {
                            const interest = this.dataset.interest;
                            if (this.classList.contains('selected')) {
                                this.classList.remove('selected');
                                selectedInterests = selectedInterests.filter(i => i !== interest);
                            } else {
                                this.classList.add('selected');
                                selectedInterests.push(interest);
                            }
                        });
                    }
                });
            }
        });

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('æ—…æ¸¸æ”»ç•¥JavaScripté”™è¯¯ä¿®å¤æµ‹è¯•é¡µé¢å·²åŠ è½½');
            console.log('æ‰€æœ‰DOMå…ƒç´ è®¿é—®éƒ½å·²æ·»åŠ å­˜åœ¨æ€§æ£€æŸ¥');
            console.log('é”™è¯¯å¤„ç†æœºåˆ¶å·²å®Œå–„');
        });
    </script>
</body>
</html> 