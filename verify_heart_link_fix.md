# å¿ƒåŠ¨é“¾æ¥ä¿®å¤éªŒè¯

## ğŸ¯ ä¿®å¤ç›®æ ‡
- `startHeartLink()` åˆ›å»ºå•äººçš„å¿ƒåŠ¨é“¾æ¥ï¼ˆç§å¯†1v1èŠå¤©ï¼‰
- ä¸äº§ç”Ÿå…¬å…±çš„é“¾æ¥
- è§£å†³ POST /tools/api/heart_link/create/ 400 é”™è¯¯

## âœ… å·²å®Œæˆçš„ä¿®å¤

### 1. ä¿®å¤APIé€»è¾‘
- **é—®é¢˜**: å½“ç”¨æˆ·å·²æœ‰è¯·æ±‚æ—¶è¿”å›400é”™è¯¯
- **è§£å†³**: 
  - å¦‚æœå·²åŒ¹é… â†’ ç›´æ¥è¿›å…¥èŠå¤©å®¤
  - å¦‚æœç­‰å¾…ä¸­ â†’ ç»§ç»­ç­‰å¾…ç°æœ‰è¯·æ±‚
  - é¿å…é‡å¤åˆ›å»ºè¯·æ±‚

### 2. ç¡®ä¿ç§å¯†æ€§
- **ä¿®æ”¹**: æ˜ç¡®è®¾ç½® `room_type='private'`
- **ç¡®ä¿**: åˆ›å»ºçš„æ˜¯ç§å¯†èŠå¤©å®¤ï¼Œä¸æ˜¯å…¬å…±çš„
- **éªŒè¯**: èŠå¤©å®¤ç±»å‹è¯†åˆ«æ–¹æ³•æ­£å¸¸å·¥ä½œ

### 3. æ›´æ–°å‰ç«¯å¤„ç†
- **å¢å¼º**: å‰ç«¯æ­£ç¡®å¤„ç†æ–°çš„å“åº”æ ¼å¼
- **æ”¯æŒ**: `continue_waiting` çŠ¶æ€å¤„ç†
- **å…¼å®¹**: æ–°æ—§æ•°æ®æ ¼å¼å…¼å®¹

## ğŸ”§ å…³é”®ä»£ç å˜æ›´

### APIå“åº”æ ¼å¼ä¼˜åŒ–:
```json
{
  "success": true,
  "request": {
    "id": "request_id",
    "status": "matched|pending",
    "room_id": "private_room_id",
    "matched": true|false,
    "redirect": "/tools/heart_link/chat/room_id/"
  }
}
```

### èŠå¤©å®¤ç±»å‹:
```python
ChatRoom.objects.create(
    room_id=str(uuid.uuid4()),
    user1=user,
    status='waiting',
    room_type='private'  # ç§å¯†ç±»å‹ï¼Œéå…¬å…±
)
```

## ğŸ§ª æµ‹è¯•éªŒè¯

ç°åœ¨ `startHeartLink()` åº”è¯¥:
1. âœ… åˆ›å»ºç§å¯†çš„1v1èŠå¤©å®¤
2. âœ… ä¸ä¼šäº§ç”Ÿå…¬å…±é“¾æ¥
3. âœ… æ­£ç¡®å¤„ç†ç°æœ‰è¯·æ±‚
4. âœ… è¿”å›200çŠ¶æ€ç è€Œé400

## ğŸ“‹ ç”¨æˆ·ä½“éªŒæ”¹è¿›
- **ä¹‹å‰**: 400é”™è¯¯ â†’ ç”¨æˆ·å›°æƒ‘
- **ç°åœ¨**: æ™ºèƒ½å¤„ç† â†’ æ— ç¼ä½“éªŒ
  - å·²åŒ¹é… â†’ ç›´æ¥è¿›å…¥èŠå¤©
  - ç­‰å¾…ä¸­ â†’ ç»§ç»­ç­‰å¾…
  - æ–°è¯·æ±‚ â†’ åˆ›å»ºç§å¯†èŠå¤©

## ğŸ‰ ä¿®å¤å®Œæˆ
å¿ƒåŠ¨é“¾æ¥ç°åœ¨å®Œå…¨ä¸“æ³¨äºå•äººç§å¯†åŒ¹é…ï¼Œä¸ç¾¤èŠåŠŸèƒ½å®Œå…¨åˆ†ç¦»ï¼
